LH_NH == "NB" & bot_genus == "Larix" ~ 'lae',
TRUE ~ 'fi'),
# BWI species groups according to Methodikband zur 3. Waldinventur 2012: ei, bu, aLh, aLn, ki, fi
BWI_SP_group = case_when(LH_NH == "LB" & bot_genus == "Quercus"~ 'ei',
LH_NH == "LB" & bot_genus == "Fagus"~ 'bu',
LH_NH == "LB" & bot_genus %in% c("Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus") | LH_NH == "LB" & bot_name == "Prunus dulcis" ~ 'aLh',
LH_NH == "LB" & !(bot_genus %in% c("Quercus",
"Fagus",
"Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus")) | LH_NH == "LB" & bot_name != "Prunus dulcis" ~ 'aLn',
LH_NH == "NB" & bot_genus %in% c("Pinus", "Larix") ~ 'ki',
LH_NH == "NB" & !(bot_genus %in% c("Pinus", "Larix"))  ~ 'fi',
TRUE ~ 'other'),
# Biomass species groups to assgn the correct coefficients for the biomass functions of GHGI
Bio_SP_group = case_when(LH_NH == "LB" & bot_genus == "Quercus"~ 'ei',
# https://www.statology.org/not-in-r/
LH_NH == "LB" & bot_genus %in% c("Fagus",     # all species that are labelled "aLh" in the BWI are treated as  beech
"Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus") | LH_NH == "LB" & bot_name == "Prunus dulcis" ~ 'bu',
LH_NH == "LB" & !(bot_genus %in% c("Quercus",  # all species that would be labelled "aLn" in the BWI species groups are allocated to soft hardwoods
"Fagus",
"Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus")) | LH_NH == "LB" & bot_name != "Prunus dulcis" ~ 'shw',
LH_NH == "NB" & bot_genus %in% c("Pinus", "Larix") ~ 'ki',
LH_NH == "NB" & !(bot_genus %in% c("Pinus", "Larix"))  ~ 'fi', # all coniferous species that are not Pine or larch are treated as spruce
TRUE ~ 'other'),
# species groups to assign the correct woody biomass nitrogen content
# available groups/ species : BU, EI, ES, AH, BI, ERL, FI, KI, DGL
N_SP_group = case_when(LH_NH == "LB" & bot_genus == "Quercus"~ 'EI',
# LH_NH == "LB" & bot_genus == "Fagus" ~ 'BU',
LH_NH == "LB" & bot_genus == "Acer"~ 'AH',
LH_NH == "LB" & bot_genus == "Fraxinus"~ 'ES',
LH_NH == "LB" & bot_genus == "Betula"~ 'BI',
LH_NH == "LB" & bot_genus == "Alnus"~ 'ERL',
LH_NH == "LB" & bot_genus %in% c("Fagus",
"Platanus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus") | LH_NH == "LB" & bot_name == "Prunus dulcis" ~ 'BU', # species that are ususally "anderes Laubholz Hoher lebenserwartung are allocated to BU
LH_NH == "LB" & !(bot_genus %in% c("Quercus",
"Fagus",
"Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus",
"Betula",
"Alnus")) | LH_NH == "LB" & bot_name != "Prunus dulcis" ~ 'BI',  # species that are usually "anderes laubholz niedriger Lebenserwartung are allovated to BI
LH_NH == "NB" & bot_genus %in% c("Pinus", "Larix") ~ 'KI',
LH_NH == "NB" & bot_genus %in% c("Pseudotzuga") ~ 'DGL',
LH_NH == "NB" & !(bot_genus %in% c("Pinus", "Larix", "Pseudotzuga"))  ~ 'FI', # all species not Pinus, Larix or DOuglas fir are treated as Spruce
TRUE ~ 'other'),
# species groups to select the correct belowground nitrogen content
N_bg_SP_group = case_when(LH_NH == "LB" & bot_genus == "Quercus"~ 'EI',
LH_NH == "LB" & bot_genus == "Fagus"~ 'BU',
LH_NH == "LB" & bot_genus %in% c("Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus") | LH_NH == "LB" & bot_name == "Prunus dulcis" ~ 'BU',
LH_NH == "LB" & !(bot_genus %in% c("Quercus",
"Fagus",
"Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus")) | LH_NH == "LB" & bot_name != "Prunus dulcis" ~ 'BI',
LH_NH == "NB" & bot_genus == "Pinus" & bot_name != "Pinus nigra" ~ 'KI',
LH_NH == "NB" & bot_genus == "Pinus" & bot_name == "Pinus nigra" ~ 'KIN',
LH_NH == "NB" & bot_genus == "Larix" ~ 'LA',
LH_NH == "NB" & !(bot_genus %in% c("Pinus", "Larix"))  ~ 'FI',
TRUE ~ 'other'),
# specie group to assing the correct foliage biomass nitrogen content
N_f_SP_group_MoMoK = case_when(LH_NH == "LB" & bot_genus == "Alnus" ~ 'ERL',
LH_NH == "LB" & bot_genus == "Betula" ~ 'BI',
LH_NH == "LB" & !(bot_genus %in% c("Alnus", "Betula")) ~ 'aLB', # other broadleafed tree (anderer Laubbaum)
LH_NH == "NB" & bot_genus == "Pinus" ~ 'KI',
LH_NH == "NB" & bot_genus == "Picea" ~ 'FI',
LH_NH == "NB" & !(bot_genus %in% c("Pinus", "Picea")) ~ 'aNB',   # # other coniferous tree (anderer Nadelbaum)
TRUE ~ "other"),
# species groups to apply the biomass functions by Wolff to the regeneration trees
RG_Wolff_bio = case_when(bot_genus == "Acer" ~ "BAH",
bot_genus == "Fraxinus" |
BWI_SP_group == "aLh"  &
!(bot_genus %in% c("Acer",
"Fagus",
"Quercus",
"Rhamnus",
"Sorbus",
"Sambucus")) ~ "ES",
bot_genus == "Betulus" |
# and all other trees in the "short life expectancy BWI species" group which are not separately grouped
BWI_SP_group == "aLn" &
!(bot_genus %in% c("Acer",
"Fagus",
"Quercus",
"Rhamnus",
"Sorbus",
"Sambucus")) ~ "BI",
bot_genus == "Sambucus" ~ "HOL",
bot_genus == "Fagus" ~ "BU",
bot_genus == "Quercus" ~ "EI",
bot_genus == "Rhamnus" ~ "FKD",
bot_genus == "Sorbus" ~ "VB",
bot_genus == "Picea" |
LH_NH == "NB" & !(bot_genus %in% c("Pinus", "Picea")) ~ "FI",
bot_genus == "Pinus"~ "KI",
TRUE ~ "BU"),
BWI_comparisson_group = case_when(LH_NH == "LB" & bot_genus == "Quercus"~ 'ei',
LH_NH == "LB" & bot_genus == "Fagus"~ 'bu',
LH_NH == "LB" & bot_genus %in% c("Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus") | LH_NH == "LB" & bot_name == "Prunus dulcis" ~ 'aLh',
LH_NH == "LB" & !(bot_genus %in% c("Quercus",
"Fagus",
"Acer",
"Platanus",
"Fraxinus",
"Tilia",
"Juglans",
"Corylus",
"Robinia",
"Castanea",
"Carpinus",
"Aesculus",
"Sorbus",
"Ulmus",
"Rhamnus")) | LH_NH == "LB" & bot_name != "Prunus dulcis" ~ 'aLn',
LH_NH == "NB" & bot_genus %in% c("Pinus") ~ 'ki',
LH_NH == "NB" & bot_genus %in% c("Pseudotsuga") ~ 'dgl',
LH_NH == "NB" & bot_genus %in% c("Abies") ~ 'ta',
LH_NH == "NB" & bot_genus %in% c("Larix") ~ 'lae',
LH_NH == "NB" & bot_genus %in% c("Picea") |
LH_NH == "NB" & !(bot_genus %in% c("Pinus",
"Pseudotsuga", "Abies",
"Larix")) ~ 'fi',
TRUE ~ 'other')
)
# export x_bart with TapeS common ID: https://stackoverflow.com/questions/53089219/specify-path-in-write-csv-function
write.csv(SP_names_com_ID_tapeS, "output/out_data/x_bart_tapeS.csv")
bark_div %>%
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# solt those species out that allready have a spp. summary
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
select(bot_genus, bark_type) %>%
group_by(bot_genus)
bark_div %>%
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# solt those species out that allready have a spp. summary
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
select(bot_genus, bark_type) %>%
group_by(bot_genus) %>% summarise(n = n())
bark_div %>%
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# solt those species out that allready have a spp. summary
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
select(bot_genus, bark_type) %>%
group_by(bot_genus) %>% summarise(n = n())
filter(n > 1)
bark_div %>%
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# solt those species out that allready have a spp. summary
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
select(bot_genus, bark_type) %>%
group_by(bot_genus) %>% summarise(n_bark = n()) %>%
filter(n_bark > 1)
bark_div %>% semi_join(bark_div %>%
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# solt those species out that allready have a spp. summary
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
select(bot_genus, bark_type) %>%
group_by(bot_genus) %>% summarise(n_bark = n()) %>%
filter(n_bark > 1), by = "bot_genus")
bark_div %>% semi_join(bark_div %>%
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# solt those species out that allready have a spp. summary
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
select(bot_genus, bark_type) %>%
group_by(bot_genus) %>% summarise(n_bark = n()) %>%
filter(n_bark > 1), by = "bot_genus") %>%
select(bot_genus, bark_type) %>% distinct() %>%
mutate(bot_species = "spp.")
bark_div <-
plyr::rbind.fill(bark_div,
( bark_div %>% semi_join(bark_div %>%
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# solt those species out that allready have a spp. summary
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
select(bot_genus, bark_type) %>%
group_by(bot_genus) %>% summarise(n_bark = n()) %>%
filter(n_bark > 1), by = "bot_genus") %>%
select(bot_genus, bark_type) %>% distinct() %>%
mutate(bot_species = "spp.") %>%
unite("species", c(bot_genus, bot_species), sep = " ", remove = FALSE))
) %>% distinct() %>% arrange(species)
bark_div <-
plyr::rbind.fill(bark_div,
(bark_div %>%
# semi join (filter) for those trees that have multiple species listed and summarize their bark type and create a common group for them
# withthe bot_species spp.
semi_join(
bark_div %>%
# filter for those trees that are not already summarised to spp. groups or that are not conifer/ broadleaf overall group
filter(bot_species != "spp." & !(bot_genus %in% c("conifer","broadleaf"))) %>%
# sort those species out that allready have a spp. summary but also separate species (e.g. Pinus nigra, Pinus spp.)
anti_join(., bark_div %>%
filter(bot_species == "spp." | bot_genus %in% c("conifer","broadleaf")) %>%
select(bot_genus),
by = "bot_genus") %>%
# select only bot_genus and bark type
select(bot_genus, bark_type) %>%
group_by(bot_genus) %>%
# count rows per species
summarise(n_bark = n()) %>%
# filter for bot_geni that have more then one representative in the Storch table
filter(n_bark > 1),
# finish the semi join
by = "bot_genus") %>%
# take the selected species and bark types and narrow them down
select(bot_genus, bark_type) %>% distinct() %>%
# create "bot_species" column indicating summary with spp.
mutate(bot_species = "spp.") %>%
# create column "species"
unite("species", c(bot_genus, bot_species), sep = " ", remove = FALSE))) %>%
distinct() %>% arrange(species)
c(unique(bark_div$bot_genus))
SP_names_com_ID_tapeS %>%
mutate(bark_type_SP_group = bot_name) %>%
case_when(bot_genus == "Acer" & !(bot_species %in% c("pseudoplatanus", "campestre", "platanoides")) ~ "Acer spp.",
bot_genus == "Alnus" ~ "Alnus spp.",
bot_genus == "Betula" ~ "Betula spp.",
bot_genus == "Carpinus" ~ "Carpinus betulus",
bot_genus == "Castanea" ~ "Castanea sativa",
bot_genus == "Fagus" ~ "Fagus sylvatica",
bot_genus == "Larix" & !(bot_species %in% c("decidua", "kaempferi")) ~ "Larix spp.",
bot_genus == "Malus"~ "Malus sylvestris",
bot_genus == "Picea" ~ "Picea abies",
bot_genus == "Pinus" & !(bot_species %in% c("nigra")) ~ "Pinus spp." ,
bot_genus == "Populus" & !(bot_species %in% c("balsamifera")) ~ "Populus spp.",
bot_genus == "Prunus" ~ "Prunus avium",
bot_genus == "Pseudotsuga" ~ "Pseudotsuga menziesii",
bot_genus == "Quercus" & !(bot_species %in% c("rubra")) ~ "Quercus spp.",
bot_genus == "Robinia" ~ "Robinia pseudoacacia",
bot_genus == "Salix" ~ "Salix spp.",
bot_genus == "Sorbus" & !(bot_species %in% c("aria", "domestica","torminalis" )) ~ "Sorbus spp.",
bot_genus == "Taxus" ~ "Taxus baccata",
bot_genus == "Tilia" ~ "Tilia spp.",
bot_genus == "Ulmus" ~ "Ulmus spp.",
# if the bot_genus is not in the list but its a conferous tree, treat it like Picea abies
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "NB" ~ "Picea abies",
# if the bot_genus is not in the list but its a broadleaf tree, treat it like Fagus silvatica
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "LB" ~ "Fagus sylvatica",
TRUE ~ bark_type_SP_group
)
SP_names_com_ID_tapeS %>%
mutate(bark_type_SP_group = bot_name) %>%
mutate(bark_type_SP_group = case_when(bot_genus == "Acer" & !(bot_species %in% c("pseudoplatanus", "campestre", "platanoides")) ~ "Acer spp.",
bot_genus == "Alnus" ~ "Alnus spp.",
bot_genus == "Betula" ~ "Betula spp.",
bot_genus == "Carpinus" ~ "Carpinus betulus",
bot_genus == "Castanea" ~ "Castanea sativa",
bot_genus == "Fagus" ~ "Fagus sylvatica",
bot_genus == "Larix" & !(bot_species %in% c("decidua", "kaempferi")) ~ "Larix spp.",
bot_genus == "Malus"~ "Malus sylvestris",
bot_genus == "Picea" ~ "Picea abies",
bot_genus == "Pinus" & !(bot_species %in% c("nigra")) ~ "Pinus spp." ,
bot_genus == "Populus" & !(bot_species %in% c("balsamifera")) ~ "Populus spp.",
bot_genus == "Prunus" ~ "Prunus avium",
bot_genus == "Pseudotsuga" ~ "Pseudotsuga menziesii",
bot_genus == "Quercus" & !(bot_species %in% c("rubra")) ~ "Quercus spp.",
bot_genus == "Robinia" ~ "Robinia pseudoacacia",
bot_genus == "Salix" ~ "Salix spp.",
bot_genus == "Sorbus" & !(bot_species %in% c("aria", "domestica","torminalis" )) ~ "Sorbus spp.",
bot_genus == "Taxus" ~ "Taxus baccata",
bot_genus == "Tilia" ~ "Tilia spp.",
bot_genus == "Ulmus" ~ "Ulmus spp.",
# if the bot_genus is not in the list but its a conferous tree, treat it like Picea abies
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "NB" ~ "Picea abies",
# if the bot_genus is not in the list but its a broadleaf tree, treat it like Fagus silvatica
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "LB" ~ "Fagus sylvatica",
TRUE ~ bark_type_SP_group
))
view(SP_names_com_ID_tapeS %>%
mutate(bark_type_SP_group = bot_name) %>%
mutate(bark_type_SP_group = case_when(bot_genus == "Acer" & !(bot_species %in% c("pseudoplatanus", "campestre", "platanoides")) ~ "Acer spp.",
bot_genus == "Alnus" ~ "Alnus spp.",
bot_genus == "Betula" ~ "Betula spp.",
bot_genus == "Carpinus" ~ "Carpinus betulus",
bot_genus == "Castanea" ~ "Castanea sativa",
bot_genus == "Fagus" ~ "Fagus sylvatica",
bot_genus == "Larix" & !(bot_species %in% c("decidua", "kaempferi")) ~ "Larix spp.",
bot_genus == "Malus"~ "Malus sylvestris",
bot_genus == "Picea" ~ "Picea abies",
bot_genus == "Pinus" & !(bot_species %in% c("nigra")) ~ "Pinus spp." ,
bot_genus == "Populus" & !(bot_species %in% c("balsamifera")) ~ "Populus spp.",
bot_genus == "Prunus" ~ "Prunus avium",
bot_genus == "Pseudotsuga" ~ "Pseudotsuga menziesii",
bot_genus == "Quercus" & !(bot_species %in% c("rubra")) ~ "Quercus spp.",
bot_genus == "Robinia" ~ "Robinia pseudoacacia",
bot_genus == "Salix" ~ "Salix spp.",
bot_genus == "Sorbus" & !(bot_species %in% c("aria", "domestica","torminalis" )) ~ "Sorbus spp.",
bot_genus == "Taxus" ~ "Taxus baccata",
bot_genus == "Tilia" ~ "Tilia spp.",
bot_genus == "Ulmus" ~ "Ulmus spp.",
# if the bot_genus is not in the list but its a conferous tree, treat it like Picea abies
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "NB" ~ "Picea abies",
# if the bot_genus is not in the list but its a broadleaf tree, treat it like Fagus silvatica
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "LB" ~ "Fagus sylvatica",
TRUE ~ bark_type_SP_group
)))
view(SP_names_com_ID_tapeS %>%
mutate(bark_type_SP_group = bot_name) %>%
mutate(bark_type_SP_group = case_when( bot_genus == "Abies" ~ "Abies alba",
bot_genus == "Acer" & !(bot_species %in% c("pseudoplatanus", "campestre", "platanoides")) ~ "Acer spp.",
bot_genus == "Alnus" ~ "Alnus spp.",
bot_genus == "Betula" ~ "Betula spp.",
bot_genus == "Carpinus" ~ "Carpinus betulus",
bot_genus == "Castanea" ~ "Castanea sativa",
bot_genus == "Fagus" ~ "Fagus sylvatica",
bot_genus == "Larix" & !(bot_species %in% c("decidua", "kaempferi")) ~ "Larix spp.",
bot_genus == "Malus"~ "Malus sylvestris",
bot_genus == "Picea" ~ "Picea abies",
bot_genus == "Pinus" & !(bot_species %in% c("nigra")) ~ "Pinus spp." ,
bot_genus == "Populus" & !(bot_species %in% c("balsamifera")) ~ "Populus spp.",
bot_genus == "Prunus" ~ "Prunus avium",
bot_genus == "Pseudotsuga" ~ "Pseudotsuga menziesii",
bot_genus == "Quercus" & !(bot_species %in% c("rubra")) ~ "Quercus spp.",
bot_genus == "Robinia" ~ "Robinia pseudoacacia",
bot_genus == "Salix" ~ "Salix spp.",
bot_genus == "Sorbus" & !(bot_species %in% c("aria", "domestica","torminalis" )) ~ "Sorbus spp.",
bot_genus == "Taxus" ~ "Taxus baccata",
bot_genus == "Tilia" ~ "Tilia spp.",
bot_genus == "Ulmus" ~ "Ulmus spp.",
# if the bot_genus is not in the list but its a conferous tree, treat it like Picea abies
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "NB" ~ "Picea abies",
# if the bot_genus is not in the list but its a broadleaf tree, treat it like Fagus silvatica
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "LB" ~ "Fagus sylvatica",
TRUE ~ bark_type_SP_group
)))
view(SP_names_com_ID_tapeS %>%
mutate(bark_type_SP_group = bot_name) %>%
mutate(bark_type_SP_group = case_when( bot_genus == "Abies" ~ "Abies alba",
bot_genus == "Acer" & !(bot_species %in% c("pseudoplatanus", "campestre", "platanoides")) ~ "Acer spp.",
bot_genus == "Alnus" ~ "Alnus spp.",
bot_genus == "Betula" ~ "Betula spp.",
bot_genus == "Carpinus" ~ "Carpinus betulus",
bot_genus == "Castanea" ~ "Castanea sativa",
bot_genus == "Fagus" ~ "Fagus sylvatica",
bot_genus == "Larix" & !(bot_species %in% c("decidua", "kaempferi")) ~ "Larix spp.",
bot_genus == "Malus"~ "Malus sylvestris",
bot_genus == "Picea" ~ "Picea abies",
bot_genus == "Pinus" & !(bot_species %in% c("nigra")) ~ "Pinus spp." ,
bot_genus == "Populus" & !(bot_species %in% c("balsamifera")) ~ "Populus spp.",
bot_genus == "Prunus" ~ "Prunus avium",
bot_genus == "Pseudotsuga" ~ "Pseudotsuga menziesii",
bot_genus == "Quercus" & !(bot_species %in% c("rubra")) ~ "Quercus spp.",
bot_genus == "Robinia" ~ "Robinia pseudoacacia",
bot_genus == "Salix" ~ "Salix spp.",
bot_genus == "Sorbus" & !(bot_species %in% c("aria", "domestica","torminalis" )) ~ "Sorbus spp.",
bot_genus == "Taxus" ~ "Taxus baccata",
bot_genus == "Tilia" ~ "Tilia spp.",
bot_genus == "Ulmus" ~ "Ulmus spp.",
bot_genus == "alii acus" ~ "conifer",
bot_genus == "alii frons" ~ "broadleaf",
bot_genus == "alii frons noble" ~ "broadleaf",
# if the bot_genus is not in the list but its a conferous tree, treat it like Picea abies
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "NB" ~ "Picea abies",
# if the bot_genus is not in the list but its a broadleaf tree, treat it like Fagus silvatica
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "LB" ~ "Fagus sylvatica",
TRUE ~ bark_type_SP_group
)))
view(SP_names_com_ID_tapeS %>%
mutate(bark_type_SP_group = bot_name) %>%
mutate(bark_type_SP_group = case_when( bot_genus == "Abies" ~ "Abies alba",
bot_genus == "Acer" & !(bot_species %in% c("pseudoplatanus", "campestre", "platanoides")) ~ "Acer spp.",
bot_genus == "Alnus" ~ "Alnus spp.",
bot_genus == "Betula" ~ "Betula spp.",
bot_genus == "Carpinus" ~ "Carpinus betulus",
bot_genus == "Castanea" ~ "Castanea sativa",
bot_genus == "Fagus" ~ "Fagus sylvatica",
bot_genus == "Fraxinus" ~ "Fraxinus excelsior",
bot_genus == "Larix" & !(bot_species %in% c("decidua", "kaempferi")) ~ "Larix spp.",
bot_genus == "Malus"~ "Malus sylvestris",
bot_genus == "Picea" ~ "Picea abies",
bot_genus == "Pinus" & !(bot_species %in% c("nigra")) ~ "Pinus spp." ,
bot_genus == "Populus" & !(bot_species %in% c("balsamifera")) ~ "Populus spp.",
bot_genus == "Prunus" ~ "Prunus avium",
bot_genus == "Pseudotsuga" ~ "Pseudotsuga menziesii",
bot_genus == "Pyrus" ~ "Pyrus pyraster",
bot_genus == "Quercus" & !(bot_species %in% c("rubra")) ~ "Quercus spp.",
bot_genus == "Robinia" ~ "Robinia pseudoacacia",
bot_genus == "Salix" ~ "Salix spp.",
bot_genus == "Sorbus" & !(bot_species %in% c("aria", "domestica","torminalis" )) ~ "Sorbus spp.",
bot_genus == "Taxus" ~ "Taxus baccata",
bot_genus == "Tilia" ~ "Tilia spp.",
bot_genus == "Ulmus" ~ "Ulmus spp.",
bot_genus == "alii acus" ~ "conifer",
bot_genus == "alii frons" ~ "broadleaf",
bot_genus == "alii frons noble" ~ "broadleaf",
# if the bot_genus is not in the list but its a conferous tree, treat it like Picea abies
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "NB" ~ "Picea abies",
# if the bot_genus is not in the list but its a broadleaf tree, treat it like Fagus silvatica
!(bot_genus %in% c(unique(bark_div$bot_genus))) &  LH_NH == "LB" ~ "Fagus sylvatica",
TRUE ~ bark_type_SP_group
)))

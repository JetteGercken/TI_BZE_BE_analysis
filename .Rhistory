# sum of masses per plot per grouping variable and conversion into tonns
B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
# dataset with are per plot cnsidreing multpiple sampling circuits per plot
left_join(., DW_total %>%
select(plot_ID, CCS_nr) %>%
distinct() %>%
mutate(CCS_A_ha = c_A(12.62)/10000) %>%
group_by(plot_ID) %>%
summarize(plot_A_ha = sum(CCS_A_ha)),
by = "plot_ID") %>%
mutate(B_t_ha = B_t/plot_A_ha,
C_t_ha = C_t/plot_A_ha,
N_t_ha = N_t/plot_A_ha) %>%
# data set with total biomass, carbon, nitrogen per plot and species group
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, SP_group, DW_type, dec_type) %>%
summarise(B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, SP_group, compartiment) %>%
summarise(plot_B_tot_t = sum(B_t),
plot_C_tot_t = sum(C_t),
plot_N_tot_t = sum(N_t)),
by= c("plot_ID", "SP_group")) %>%
mutate(C_share = (C_t/plot_C_tot_t)*100,
N_share = (N_t/plot_N_tot_t)*100,
B_share = (B_t/plot_B_tot_t)*100) %>%
dplyr::select(-c("B_t", "C_t", "N_t", "plot_B_tot_t", "plot_C_tot_t", "plot_N_tot_t", "compartiment")),
by = c("plot_ID", "SP_group", "DW_type", "dec_type"))
write.csv(DW_P_SP_TY_DEC, paste0(momok.out.home,"DW_P_SP_TY_DEC_MoMoK.csv"))
# ----- 2.5.2.2.grouped by plot, species, deadwood type -------------------------
DW_P_SP_TY <- DW_total %>%
group_by(plot_ID, SP_group, DW_type, compartiment) %>%
summarise(D_mean = mean(D_cm),
L_mean = mean(L_m),
B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
# dataset with are per plot cnsidreing multpiple sampling circuits per plot
left_join(., DW_total %>%
select(plot_ID, CCS_nr) %>%
distinct() %>%
mutate(CCS_A_ha = c_A(12.62)/10000) %>%
group_by(plot_ID) %>%
summarize(plot_A_ha = sum(CCS_A_ha)),
by = "plot_ID") %>%
mutate(B_t_ha = B_t/plot_A_ha,
C_t_ha = C_t/plot_A_ha,
N_t_ha = N_t/plot_A_ha) %>%
# data set with total biomass/
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, SP_group, DW_type) %>%
summarise(B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, SP_group) %>%
summarise(plot_B_tot_t = sum(B_t),
plot_C_tot_t = sum(C_t),
plot_N_tot_t = sum(N_t)),
by= c("plot_ID", "SP_group")) %>%
mutate(C_share = (C_t/plot_C_tot_t)*100,
N_share = (N_t/plot_N_tot_t)*100,
B_share = (B_t/plot_B_tot_t)*100) %>%
dplyr::select(- c("plot_B_tot_t", "plot_C_tot_t", "plot_N_tot_t", "B_t", "C_t", "N_t")),
by = c("plot_ID", "SP_group", "DW_type"))
write.csv(DW_P_SP_TY, paste0(momok.out.home, "DW_P_SP_TY_MoMoK.csv"))
# ----- 2.5.2.3.grouped by decay type and deadwood type -------------------------
DW_P_TY_DEC <- DW_total %>%
group_by(plot_ID, dec_type, DW_type, compartiment) %>%
summarise(D_mean = mean(D_cm),
L_mean = mean(L_m),
B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
# dataset with are per plot cnsidreing multpiple sampling circuits per plot
left_join(., DW_total %>%
select(plot_ID, CCS_nr) %>%
distinct() %>%
mutate(CCS_A_ha = c_A(12.62)/10000) %>%
group_by(plot_ID) %>%
summarize(plot_A_ha = sum(CCS_A_ha)),
by = "plot_ID") %>%
mutate(B_t_ha = B_t/plot_A_ha,
C_t_ha = C_t/plot_A_ha,
N_t_ha = N_t/plot_A_ha) %>%
# data set with total biomass/
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, dec_type, DW_type) %>%
summarise(B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, dec_type) %>%
summarise(plot_B_tot_t = sum(B_t),
plot_C_tot_t = sum(C_t),
plot_N_tot_t = sum(N_t)),
by= c("plot_ID", "dec_type")) %>%
mutate(C_share = (C_t/plot_C_tot_t)*100,
N_share = (N_t/plot_N_tot_t)*100,
B_share = (B_t/plot_B_tot_t)*100) %>%
dplyr::select(- c("plot_B_tot_t", "plot_C_tot_t", "plot_N_tot_t", "B_t", "C_t", "N_t")),
by = c("plot_ID", "dec_type", "DW_type"))
write.csv(DW_P_TY_DEC, paste0(momok.out.home, "DW_P_TY_DEC_MoMoK.csv"))
# ----- 2.5.2.4.grouped by plot, species, decay type -----------------------------
DW_P_SP_DEC <- DW_total %>%
group_by(plot_ID, SP_group, dec_type, compartiment) %>%
summarise(D_mean = mean(D_cm),
L_mean = mean(L_m),
B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
# dataset with are per plot cnsidreing multpiple sampling circuits per plot
left_join(., DW_total %>%
select(plot_ID, CCS_nr) %>%
distinct() %>%
mutate(CCS_A_ha = c_A(12.62)/10000) %>%
group_by(plot_ID) %>%
summarize(plot_A_ha = sum(CCS_A_ha)),
by = "plot_ID") %>%
mutate(B_t_ha = B_t/plot_A_ha,
C_t_ha = C_t/plot_A_ha,
N_t_ha = N_t/plot_A_ha) %>%
# data set with total biomass/
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, SP_group, dec_type) %>%
summarise(B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t)) %>%
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, SP_group) %>%
summarise(plot_B_tot_t = sum(B_t),
plot_C_tot_t = sum(C_t),
plot_N_tot_t = sum(N_t)),
by= c("plot_ID", "SP_group")) %>%
mutate(C_share = (C_t/plot_C_tot_t)*100,
N_share = (N_t/plot_N_tot_t)*100,
B_share = (B_t/plot_B_tot_t)*100) %>%
dplyr::select(- c("plot_B_tot_t", "plot_C_tot_t", "plot_N_tot_t", "B_t", "C_t", "N_t")),
by = c("plot_ID", "SP_group", "dec_type"))
# ----- 2.5.2.5.deawood biomass, carbon and nitrogen grouped decay type -----------------------------
DW_P_DEC <- DW_total %>%
group_by(plot_ID, dec_type, compartiment) %>%
summarise(D_mean = mean(D_cm),
L_mean = mean(L_m),
B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t),
V_tot_m3 = sum(na.omit(V_dw_m3))) %>%
# dataset with area per plot considering multipple sampling circuits per plot
left_join(., DW_total %>%
select(plot_ID, CCS_nr) %>%
distinct() %>%
mutate(CCS_A_ha = c_A(12.62)/10000) %>%
group_by(plot_ID) %>%
summarize(plot_A_ha = sum(CCS_A_ha)) %>%
mutate(MoMoK_A_ha = (50*50)/10000),     # calculate momok area
by = "plot_ID") %>%
# hectar values
mutate(B_t_ha = B_t/plot_A_ha,
C_t_ha = C_t/plot_A_ha,
N_t_ha = N_t/plot_A_ha,
V_tot_m3_ha = V_tot_m3/plot_A_ha,
# momok area values
B_t_MA = (B_t/plot_A_ha)*MoMoK_A_ha,
C_t_MA = (C_t/plot_A_ha)*MoMoK_A_ha,
N_t_MA = (N_t/plot_A_ha)*MoMoK_A_ha,
V_tot_m3_MA = (V_tot_m3/plot_A_ha)*MoMoK_A_ha) %>%
# data set with total biomass/
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, dec_type) %>%
summarise(B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t),
V_tot_m3 = sum(na.omit(V_dw_m3))) %>%
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID) %>%
summarise(plot_B_tot_t = sum(B_t),
plot_C_tot_t = sum(C_t),
plot_N_tot_t = sum(N_t),
plot_V_tot_m3 = sum(V_dw_m3)),
by = "plot_ID") %>%
mutate(C_share = (C_t/plot_C_tot_t)*100,
N_share = (N_t/plot_N_tot_t)*100,
B_share = (B_t/plot_B_tot_t)*100,
V_share = (V_tot_m3/plot_V_tot_m3)*100) %>%
dplyr::select(- c("plot_B_tot_t", "plot_C_tot_t", "plot_N_tot_t", "B_t", "C_t", "N_t",  "V_tot_m3", "plot_V_tot_m3")),
by = c("plot_ID","dec_type"))
write.csv(DW_P_DEC, paste0(momok.out.home, "DW_P_DEC_MoMoK.csv"))
# ----- 2.5.2.6.deawood by deadwood type -----------------------------
DW_P_TY <- DW_total %>%
# dataset grouped by plot and deadwood type
group_by(plot_ID, DW_type, compartiment) %>%
summarise(D_mean = mean(D_cm),
L_mean = mean(L_m),
B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t),
V_tot_m3 = sum(na.omit(V_dw_m3))) %>%
#plot_A_ha = sum(c_A(12.62)/10000)) %>%
# dataset with are per plot cnsidreing multpiple sampling circuits per plot
left_join(., DW_total %>%
select(plot_ID, CCS_nr) %>%
distinct() %>%
mutate(CCS_A_ha = c_A(12.62)/10000) %>%
group_by(plot_ID) %>%
summarize(plot_A_ha = sum(CCS_A_ha)) %>% # calculate sum of area of all sampling circuits per plot to get plot area
mutate(MoMoK_A_ha = (50*50)/10000),     # calculate momok area
by = "plot_ID") %>%
# hectar values
mutate(B_t_ha = B_t/plot_A_ha,
C_t_ha = C_t/plot_A_ha,
N_t_ha = N_t/plot_A_ha,
V_tot_m3_ha = V_tot_m3/plot_A_ha,
# momok area values
B_t_MA = (B_t/plot_A_ha)*MoMoK_A_ha,
C_t_MA = (C_t/plot_A_ha)*MoMoK_A_ha,
N_t_MA = (N_t/plot_A_ha)*MoMoK_A_ha,
V_tot_m3_MA = (V_tot_m3/plot_A_ha)*MoMoK_A_ha) %>%
# data set with total biomass/
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, DW_type) %>%
summarise(B_t = sum(B_t),
C_t = sum(C_t),
N_t = sum(N_t),
V_tot_m3 = sum(na.omit(V_dw_m3))) %>%
left_join(., DW_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID) %>%
summarise(plot_B_tot_t = sum(B_t),
plot_C_tot_t = sum(C_t),
plot_N_tot_t = sum(N_t),
plot_V_tot_m3 = sum(V_dw_m3)),
by = "plot_ID") %>%
mutate(C_share = (C_t/plot_C_tot_t)*100,
N_share = (N_t/plot_N_tot_t)*100,
B_share = (B_t/plot_B_tot_t)*100,
V_share = (V_tot_m3/plot_V_tot_m3)*100) %>%
dplyr::select(- c("plot_B_tot_t", "plot_C_tot_t", "plot_N_tot_t", "B_t", "C_t", "N_t",  "V_tot_m3", "plot_V_tot_m3")),
by = c("plot_ID","DW_type"))
write.csv(DW_P_TY, paste0(momok.out.home, "DW_P_TY_MoMoK.csv"))
# -----2.5.2.7. deadwood  by plot ---------------------------------------------------
DW_P <- DW_total %>%
group_by(plot_ID, compartiment) %>%
summarise(V_m3_plot = sum(na.omit(V_dw_m3)),
B_t_plot = sum(na.omit(B_t)),
# actually this should be the B_t_ha because it also includes the fine wood compartiment,
# which is not included in the transformation from volume to biomass performed by the BWI
#B_t_tapes_plot = sum(na.omit(tons(dw_ag_kg))),
C_t_plot = sum(na.omit(C_t)),
N_t_plot = sum(na.omit(N_t)),
Nt_plot = n()) %>%
# dataset with are per plot cnsidreing multpiple sampling circuits per plot
left_join(., DW_total %>%
select(plot_ID, CCS_nr) %>%
distinct() %>%
mutate(CCS_A_ha = c_A(12.62)/10000) %>%
group_by(plot_ID) %>%
summarize(plot_A_ha = sum(CCS_A_ha))%>%
mutate(MoMoK_A_ha = (50*50)/10000),
by = "plot_ID") %>%
mutate(V_m3_ha = V_m3_plot/plot_A_ha,
B_t_ha = B_t_plot/plot_A_ha,
#B_t_tapes_ha = B_t_tapes_plot/ plot_A_ha,
C_t_ha = C_t_plot/plot_A_ha,
N_t_ha = N_t_plot/plot_A_ha,
Nt_ha = Nt_plot/plot_A_ha,
# referring carbon & nitrogen stocks to actual Momok size
V_m3_MA = (V_m3_plot/plot_A_ha)*MoMoK_A_ha,
B_t_MA = (B_t_plot/plot_A_ha)*MoMoK_A_ha,
#B_t_tapes_MA = (B_t_tapes_plot/ plot_A_ha)*MoMoK_A_ha,
C_t_MA = (C_t_plot/ plot_A_ha)*MoMoK_A_ha,
N_t_MA = (N_t_plot/plot_A_ha)*MoMoK_A_ha,
Nt_MA = (Nt_plot/ plot_A_ha)*MoMoK_A_ha) %>%
# number of decay types per plot
left_join(., DW_total %>%
select(plot_ID, dec_type) %>%
group_by(plot_ID) %>%
distinct() %>%
summarise(N_dec_type_plot = n()),
by = "plot_ID") %>%
# number of deadwood types per plot
left_join(., DW_total %>%
select(plot_ID, DW_type) %>%
group_by(plot_ID) %>%
distinct() %>%
summarise(N_DW_type_plot = n()),
by = "plot_ID")
summary(DW_P)
write.csv(DW_P, paste0(momok.out.home, "DW_P_MoMoK.csv"))
# ----- 2.5.4. REGENERATION plot level -------------------------------------------------------------------
# ----- 2.5.4.1. grouped by Plot and species  ------------------------------------------------------------------
RG_P_SP <- RG_total %>%
# sum plot area of all sampling circuits per plot together to calcualte plot area to reffer data to hectare
left_join(., RG_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, CCS_nr) %>%
summarise(CCS_max_dist_m = mean(CCS_max_dist/100)) %>%
mutate(CCS_A_ha = c_A(CCS_max_dist_m)/10000) %>%  # 10000 to transform m2 into ha, the plot radius has to be the distance of furthest plant to the RG sampling circuit
group_by(plot_ID) %>%
summarise(plot_A_ha = sum(CCS_A_ha)),
by = "plot_ID") %>%
# summing up biomass, carbon and nitrogen per speices, plot and compartiment
group_by(plot_ID, SP_code, compartiment) %>%                            # group by plot and species to calculate BA per species
summarise(B_t_plot = sum(B_t),
C_t_plot = sum(C_t),                           # sum of  carbon stock per plot,  species and compartiment
N_t_plot = sum(na.omit(N_t)),      # sum of aboveground Nitrogen stock per plot and species and compartiment
plot_A_ha = mean(plot_A_ha)) %>% # plot area
mutate(MoMok_A_ha = (50*50)/10000,                 # momok area 0.25 ha
# B, C, N hectar values
B_t_ha = B_t_plot/plot_A_ha,
C_t_ha = C_t_plot/plot_A_ha,
N_t_ha = N_t_plot/plot_A_ha,
# B, C, N  MoMoK area values
B_t_MA = (B_t_plot/plot_A_ha)*MoMok_A_ha,
C_t_MA = (C_t_plot/plot_A_ha)*MoMok_A_ha,
N_t_MA = (N_t_plot/plot_A_ha)*MoMok_A_ha) %>%
# join in mean diameter and height per plot and species group (grouped separately to avoid repetition with every compartiment)
left_join(., RG_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, SP_code) %>%
summarise(mean_D_cm = mean(D_cm),                         # mean diameter per species per canopy layer per plot
mean_H_m = mean(H_cm/100),                      # mean height per species per canopy layer per plot
#SP_BA_m2_plot = sum(c_A(D_cm/2)),               # Basal area in m2 per plot and speices --> doesnt make sense bacause not all trees have a diameter
N_trees_plot = n()), # %>%                          # number of individuals per plot and species
#  mutate(compartiment = "total"),                           # just to enable a clean join
by = c("plot_ID", "SP_code")) %>%
# join in C, N and number of trees of whole plot to calculate shares
left_join(., RG_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, CCS_nr) %>%
summarise(CCS_max_dist_m = mean(CCS_max_dist/100),
CCS_tot_B_t = sum(B_t),
CCS_tot_C_t = sum(C_t),                    # total C stock in tons per sampling circuit
CCs_tot_N_t = sum(na.omit(N_t)),     # total N stock in tons per sampling circuit
CCS_tot_N_trees = n()) %>%                 # 10000 to transform m2 into ha, the plot radius has to be the distance of furthest plant to the RG sampling circuit
mutate(CCS_A_ha = c_A(CCS_max_dist_m)/10000) %>%
group_by(plot_ID) %>%
summarise(plot_A_ha = sum(CCS_A_ha),                  # calcualte plot area in ha by summing up area of sampling circuits per plot
plot_tot_B_t = sum(CCS_tot_B_t),
plot_tot_C_t = sum(CCS_tot_C_t),                    # total C stock in tons per plot
plot_tot_N_t = sum(CCs_tot_N_t),     # total N stock in tons per plot
plot_tot_N_trees = sum(CCS_tot_N_trees)) %>%                 # total number of trees per plot
#mutate(compartiment = "total") %>%
select(-plot_A_ha),
by = c("plot_ID")) %>%
mutate(tot_N_trees_ha = plot_tot_N_trees/plot_A_ha,                  # total number trees per ha
tot_N_trees_MA = (plot_tot_N_trees/plot_A_ha)*MoMok_A_ha,      # total number RG trees per MA
SP_N_trees_ha = N_trees_plot/ plot_A_ha,                       #  number trees per species per ha
SP_N_trees_MA =( N_trees_plot/ plot_A_ha)*MoMok_A_ha,          #  number trees per species per MA
B_SP_share = (B_t_plot/plot_tot_B_t)*100,
C_SP_share = (C_t_plot/plot_tot_C_t)*100,                      # carbon share species
N_SP_share = (N_t_plot/plot_tot_N_t)*100,                      # nitrogen share species
N_trees_SP_share =  (N_trees_plot)/plot_tot_N_trees)           # number share species
write.csv(RG_P_SP, paste0(momok.out.home, "RG_P_SP_MoMoK.csv"))
# ----- 2.5.4.2. grouped by Plot  ------------------------------------------------------------------
RG_P <- RG_total %>%
# plot area of all sampling circuits together
left_join(., RG_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID, CCS_nr) %>%
summarise(CCS_max_dist_m = mean(CCS_max_dist/100)) %>%
mutate(CCS_A_ha = c_A(CCS_max_dist_m)/10000) %>%      # 10000 to transform m2 into ha, the plot radius has to be the distance of furthest plant to the RG sampling circuit
group_by(plot_ID) %>%
summarise(plot_A_ha = sum(CCS_A_ha)) %>%
mutate(MoMoK_A_ha = (50*50)/10000),
by = "plot_ID") %>%
# summing up biomass, carbon and nitrogen per speices, plot and compartiment
group_by(plot_ID, compartiment) %>%                            # group by plot and species to calculate BA per species
summarise(B_t_plot = sum(B_t),
C_t_plot = sum(C_t),                           # sum of  carbon stock per plot,  species and compartiment
N_t_plot = sum(na.omit(N_t)),      # sum of aboveground Nitrogen stock per plot and species and compartiment
plot_A_ha = mean(plot_A_ha)) %>% # plot area
mutate(MoMok_A_ha = (50*50)/10000,                 # momok area 0.25 ha
# B, C, N hectar values
B_t_ha = B_t_plot/plot_A_ha,
C_t_ha = C_t_plot/plot_A_ha,
N_t_ha = N_t_plot/plot_A_ha,
# B, C, N  MoMoK area values
B_t_MA = (B_t_plot/plot_A_ha)*MoMok_A_ha,
C_t_MA = (C_t_plot/plot_A_ha)*MoMok_A_ha,
N_t_MA = (N_t_plot/plot_A_ha)*MoMok_A_ha) %>%
# number of species per plot
left_join(., RG_total %>%
filter(compartiment == "total") %>%
select(plot_ID, SP_code) %>%
group_by(plot_ID) %>%
distinct() %>%
summarise(N_species_plot = n()), #%>%
# mutate(compartiment = "total"),
by = c("plot_ID")) %>%
# number of RG trees per plot
left_join(., RG_total %>%
filter(compartiment == "total") %>%
group_by(plot_ID) %>%
summarise(Nt_plot = n()), #%>%
# mutate(compartiment = "total"),
by = c("plot_ID")) %>%
mutate(Nt_ha = Nt_plot/plot_A_ha,              # number of RG trees per hectar
Nt_MA = (Nt_plot/plot_A_ha)*MoMok_A_ha) # number of RG trees per MA
summary(RG_P)
write.csv(RG_P, paste0(momok.out.home, "RG_P_MoMoK.csv"))
# ----- 2.5.5.JOINT PLOTWISE: living trees, deadwood, regeneration  -------
plot_total <- rbind(
# living trees
trees_P %>%
dplyr::select(plot_ID,compartiment,
B_t_plot, C_t_plot, N_t_plot, Nt_plot,    # per plot
B_t_MA, C_t_MA, N_t_MA, Nt_MA,            # per momok area 50X50m
B_t_ha, C_t_ha, N_t_ha, Nt_ha) %>%        # per hectare
mutate(stand_component = "LT") %>%
dplyr::select(plot_ID,compartiment, stand_component,
B_t_plot, C_t_plot, N_t_plot, Nt_plot,    # per plot
B_t_MA, C_t_MA, N_t_MA, Nt_MA,            # per momok area 50X50m
B_t_ha, C_t_ha, N_t_ha, Nt_ha),           # per hectare
# regeneration trees
RG_P %>%
dplyr::select(plot_ID, compartiment,
B_t_plot, C_t_plot, N_t_plot, Nt_plot,    # per plot
B_t_MA, C_t_MA, N_t_MA, Nt_MA,            # per momok area 50X50m
B_t_ha, C_t_ha, N_t_ha, Nt_ha) %>%        # per hectare
mutate(stand_component = "RG") %>%
dplyr::select(plot_ID, compartiment, stand_component,
B_t_plot, C_t_plot, N_t_plot, Nt_plot,    # per plot
B_t_MA, C_t_MA, N_t_MA, Nt_MA,            # per momok area 50X50m
B_t_ha, C_t_ha, N_t_ha, Nt_ha),           # per hectar
# deadwood
DW_P %>%
dplyr::select(plot_ID, compartiment,
B_t_plot, C_t_plot, N_t_plot, Nt_plot,    # per plot
B_t_MA, C_t_MA, N_t_MA, Nt_MA,            # per momok area 50X50m
B_t_ha, C_t_ha, N_t_ha, Nt_ha) %>%        # per hectare
mutate(stand_component = "DW") %>%
dplyr::select(plot_ID, compartiment, stand_component,
B_t_plot, C_t_plot, N_t_plot, Nt_plot,    # per plot
B_t_MA, C_t_MA, N_t_MA, Nt_MA,            # per momok area 50X50m
B_t_ha, C_t_ha, N_t_ha, Nt_ha))           # per hectar
# add sum of all stand components together by plot and compartiment to plot total dataset
plot_total<-
rbind(plot_total,
plot_total %>%
group_by(plot_ID, compartiment) %>%
# https://dplyr.tidyverse.org/reference/across.html
summarise(across(B_t_plot:Nt_ha, ~ sum(.x, na.rm = TRUE))) %>%
mutate(stand_component = "all") %>%
dplyr::select(plot_ID, compartiment, stand_component,
B_t_plot, C_t_plot, N_t_plot, Nt_plot,    # per plot
B_t_MA, C_t_MA, N_t_MA, Nt_MA,            # per momok area 50X50m
B_t_ha, C_t_ha, N_t_ha, Nt_ha)
)
plot_total <- anti_join(plot_total, plots.to.exclude.LT.RG.DW, by = "plot_ID")
write.csv(plot_total, paste0(momok.out.home, "LB_RG_DW_Plot_MoMoK.csv"))
plot_total %>%
inner_join(., trees_total %>%
select(plot_ID, loc_name, state) %>%
filter(state == "MV" & loc_name == "Buchenhorst") %>%
distinct(),
by = "plot_ID") %>%
select(compartiment, stand_component,  C_t_ha) %>%
filter(compartiment %in% c("ag", "bg", "total")) %>%
mutate(compartiment = case_when(compartiment == "ag" ~ "oberirdisch",
compartiment == "bg" ~ "unterirdisch",
TRUE ~ "gesamt"),
stand_component = case_when(stand_component == "LT" ~ "Oberstand",
stand_component == "RG" ~ "Verjüngung",
stand_component == "all" ~ "Gesamter Bestand",
TRUE ~ "Totholz")) %>%
unite("component_compartiment", stand_component, compartiment, sep = " ") %>%
pivot_wider(names_from = component_compartiment, values_from = C_t_ha)
plot_total %>%
inner_join(., trees_total %>%
select(plot_ID, loc_name, state) %>%
filter(state == "MV" & loc_name == "Buchenhorst") %>%
distinct(),
by = "plot_ID")
plot_total %>%
inner_join(., trees_total %>%
select(plot_ID, loc_name, state) %>%
filter(state == "MV" & loc_name == "Buchenhorst") %>%
distinct(),
by = "plot_ID") %>%
select(compartiment, stand_component,  C_t_ha) %>%
filter(compartiment %in% c("ag", "bg", "total"))
plot_total %>%
inner_join(., trees_total %>%
select(plot_ID, loc_name, state) %>%
filter(state == "MV" & loc_name == "Buchenhorst") %>%
distinct(),
by = "plot_ID") %>%
select(compartiment, stand_component,  C_t_ha) %>%
filter(compartiment %in% c("ag", "bg", "total")) %>%
mutate(compartiment = case_when(compartiment == "ag" ~ "oberirdisch",
compartiment == "bg" ~ "unterirdisch",
TRUE ~ "gesamt"),
stand_component = case_when(stand_component == "LT" ~ "Oberstand",
stand_component == "RG" ~ "Verjüngung",
stand_component == "all" ~ "Gesamter Bestand",
TRUE ~ "Totholz"))
